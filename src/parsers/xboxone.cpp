// TODO: fully parse the xb1 protocol here, no shortcuts this time
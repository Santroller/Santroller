#include "lib_main.h"
static uint8_t crc5_usb_bits(const void *data, int vl, uint8_t ival) {
    const unsigned char *d = (const unsigned char *)data;
    /* This function is based on code posted by John Sullivan to Wireshark-dev
     * mailing list on Jul 21, 2019.
     *
     * "One of the properties of LFSRs is that a 1 bit in the input toggles a
     *  completely predictable set of register bits *at any point in the
     *  future*. This isn't often useful for most CRC caculations on variable
     *  sized input, as the cost of working out which those bits are vastly
     *  outweighs most other methods."
     *
     * In USB 2.0, the CRC5 is calculated on either 11 or 19 bits inputs,
     * and thus this approach is viable.
     */
    uint8_t rv = ival;
    static const uint8_t bvals[19] = {
        0x1e, 0x15, 0x03, 0x06, 0x0c, 0x18, 0x19, 0x1b,
        0x1f, 0x17, 0x07, 0x0e, 0x1c, 0x11, 0x0b, 0x16,
        0x05, 0x0a, 0x14};

    for (int i = 0; i < vl; i++) {
        uint8_t t = i & 7;
        if (bit_check(*d, t)) {
            rv ^= bvals[19 - vl + i];
        }
        if (t == 7) {
            d++;
        }
    }
    return rv;
}
uint8_t crc5_usb_11bit_input(const void *input) {
    return crc5_usb_bits(input, 11, 0x02);
}

uint8_t crc5_usb_19bit_input(const void *input) {
    return crc5_usb_bits(input, 19, 0x1d);
}

uint16_t crc_16(const void *data, size_t data_len) {
    const unsigned char *d = (const unsigned char *)data;
    unsigned int i;
    bool bit;
    unsigned char c;
    uint16_t crc = 0xffff;
    while (data_len--) {
        c = *d++;
        for (i = 0x01; i & 0xff; i <<= 1) {
            bit = crc & 0x8000;
            if (c & i) {
                bit = !bit;
            }
            crc <<= 1;
            if (bit) {
                crc ^= 0x8005;
            }
        }
        crc &= 0xffff;
    }

    uint16_t ret = crc & 0x01;
    for (i = 1; i < 16; i++) {
        crc >>= 1;
        ret = (ret << 1) | (crc & 0x01);
    }
    return ret ^ 0xffff;
}

typedef uint_fast16_t crc_t;
/**
 * Static table used for the table_driven implementation.
 */
/**
 * Static table used for the table_driven implementation.
 */
static const crc_t crc_table[16][256] = {
    {0x0000, 0xc0c1, 0xc181, 0x0140, 0xc301, 0x03c0, 0x0280, 0xc241,
     0xc601, 0x06c0, 0x0780, 0xc741, 0x0500, 0xc5c1, 0xc481, 0x0440,
     0xcc01, 0x0cc0, 0x0d80, 0xcd41, 0x0f00, 0xcfc1, 0xce81, 0x0e40,
     0x0a00, 0xcac1, 0xcb81, 0x0b40, 0xc901, 0x09c0, 0x0880, 0xc841,
     0xd801, 0x18c0, 0x1980, 0xd941, 0x1b00, 0xdbc1, 0xda81, 0x1a40,
     0x1e00, 0xdec1, 0xdf81, 0x1f40, 0xdd01, 0x1dc0, 0x1c80, 0xdc41,
     0x1400, 0xd4c1, 0xd581, 0x1540, 0xd701, 0x17c0, 0x1680, 0xd641,
     0xd201, 0x12c0, 0x1380, 0xd341, 0x1100, 0xd1c1, 0xd081, 0x1040,
     0xf001, 0x30c0, 0x3180, 0xf141, 0x3300, 0xf3c1, 0xf281, 0x3240,
     0x3600, 0xf6c1, 0xf781, 0x3740, 0xf501, 0x35c0, 0x3480, 0xf441,
     0x3c00, 0xfcc1, 0xfd81, 0x3d40, 0xff01, 0x3fc0, 0x3e80, 0xfe41,
     0xfa01, 0x3ac0, 0x3b80, 0xfb41, 0x3900, 0xf9c1, 0xf881, 0x3840,
     0x2800, 0xe8c1, 0xe981, 0x2940, 0xeb01, 0x2bc0, 0x2a80, 0xea41,
     0xee01, 0x2ec0, 0x2f80, 0xef41, 0x2d00, 0xedc1, 0xec81, 0x2c40,
     0xe401, 0x24c0, 0x2580, 0xe541, 0x2700, 0xe7c1, 0xe681, 0x2640,
     0x2200, 0xe2c1, 0xe381, 0x2340, 0xe101, 0x21c0, 0x2080, 0xe041,
     0xa001, 0x60c0, 0x6180, 0xa141, 0x6300, 0xa3c1, 0xa281, 0x6240,
     0x6600, 0xa6c1, 0xa781, 0x6740, 0xa501, 0x65c0, 0x6480, 0xa441,
     0x6c00, 0xacc1, 0xad81, 0x6d40, 0xaf01, 0x6fc0, 0x6e80, 0xae41,
     0xaa01, 0x6ac0, 0x6b80, 0xab41, 0x6900, 0xa9c1, 0xa881, 0x6840,
     0x7800, 0xb8c1, 0xb981, 0x7940, 0xbb01, 0x7bc0, 0x7a80, 0xba41,
     0xbe01, 0x7ec0, 0x7f80, 0xbf41, 0x7d00, 0xbdc1, 0xbc81, 0x7c40,
     0xb401, 0x74c0, 0x7580, 0xb541, 0x7700, 0xb7c1, 0xb681, 0x7640,
     0x7200, 0xb2c1, 0xb381, 0x7340, 0xb101, 0x71c0, 0x7080, 0xb041,
     0x5000, 0x90c1, 0x9181, 0x5140, 0x9301, 0x53c0, 0x5280, 0x9241,
     0x9601, 0x56c0, 0x5780, 0x9741, 0x5500, 0x95c1, 0x9481, 0x5440,
     0x9c01, 0x5cc0, 0x5d80, 0x9d41, 0x5f00, 0x9fc1, 0x9e81, 0x5e40,
     0x5a00, 0x9ac1, 0x9b81, 0x5b40, 0x9901, 0x59c0, 0x5880, 0x9841,
     0x8801, 0x48c0, 0x4980, 0x8941, 0x4b00, 0x8bc1, 0x8a81, 0x4a40,
     0x4e00, 0x8ec1, 0x8f81, 0x4f40, 0x8d01, 0x4dc0, 0x4c80, 0x8c41,
     0x4400, 0x84c1, 0x8581, 0x4540, 0x8701, 0x47c0, 0x4680, 0x8641,
     0x8201, 0x42c0, 0x4380, 0x8341, 0x4100, 0x81c1, 0x8081, 0x4040},
    {0x0000, 0x9001, 0x6001, 0xf000, 0xc002, 0x5003, 0xa003, 0x3002,
     0xc007, 0x5006, 0xa006, 0x3007, 0x0005, 0x9004, 0x6004, 0xf005,
     0xc00d, 0x500c, 0xa00c, 0x300d, 0x000f, 0x900e, 0x600e, 0xf00f,
     0x000a, 0x900b, 0x600b, 0xf00a, 0xc008, 0x5009, 0xa009, 0x3008,
     0xc019, 0x5018, 0xa018, 0x3019, 0x001b, 0x901a, 0x601a, 0xf01b,
     0x001e, 0x901f, 0x601f, 0xf01e, 0xc01c, 0x501d, 0xa01d, 0x301c,
     0x0014, 0x9015, 0x6015, 0xf014, 0xc016, 0x5017, 0xa017, 0x3016,
     0xc013, 0x5012, 0xa012, 0x3013, 0x0011, 0x9010, 0x6010, 0xf011,
     0xc031, 0x5030, 0xa030, 0x3031, 0x0033, 0x9032, 0x6032, 0xf033,
     0x0036, 0x9037, 0x6037, 0xf036, 0xc034, 0x5035, 0xa035, 0x3034,
     0x003c, 0x903d, 0x603d, 0xf03c, 0xc03e, 0x503f, 0xa03f, 0x303e,
     0xc03b, 0x503a, 0xa03a, 0x303b, 0x0039, 0x9038, 0x6038, 0xf039,
     0x0028, 0x9029, 0x6029, 0xf028, 0xc02a, 0x502b, 0xa02b, 0x302a,
     0xc02f, 0x502e, 0xa02e, 0x302f, 0x002d, 0x902c, 0x602c, 0xf02d,
     0xc025, 0x5024, 0xa024, 0x3025, 0x0027, 0x9026, 0x6026, 0xf027,
     0x0022, 0x9023, 0x6023, 0xf022, 0xc020, 0x5021, 0xa021, 0x3020,
     0xc061, 0x5060, 0xa060, 0x3061, 0x0063, 0x9062, 0x6062, 0xf063,
     0x0066, 0x9067, 0x6067, 0xf066, 0xc064, 0x5065, 0xa065, 0x3064,
     0x006c, 0x906d, 0x606d, 0xf06c, 0xc06e, 0x506f, 0xa06f, 0x306e,
     0xc06b, 0x506a, 0xa06a, 0x306b, 0x0069, 0x9068, 0x6068, 0xf069,
     0x0078, 0x9079, 0x6079, 0xf078, 0xc07a, 0x507b, 0xa07b, 0x307a,
     0xc07f, 0x507e, 0xa07e, 0x307f, 0x007d, 0x907c, 0x607c, 0xf07d,
     0xc075, 0x5074, 0xa074, 0x3075, 0x0077, 0x9076, 0x6076, 0xf077,
     0x0072, 0x9073, 0x6073, 0xf072, 0xc070, 0x5071, 0xa071, 0x3070,
     0x0050, 0x9051, 0x6051, 0xf050, 0xc052, 0x5053, 0xa053, 0x3052,
     0xc057, 0x5056, 0xa056, 0x3057, 0x0055, 0x9054, 0x6054, 0xf055,
     0xc05d, 0x505c, 0xa05c, 0x305d, 0x005f, 0x905e, 0x605e, 0xf05f,
     0x005a, 0x905b, 0x605b, 0xf05a, 0xc058, 0x5059, 0xa059, 0x3058,
     0xc049, 0x5048, 0xa048, 0x3049, 0x004b, 0x904a, 0x604a, 0xf04b,
     0x004e, 0x904f, 0x604f, 0xf04e, 0xc04c, 0x504d, 0xa04d, 0x304c,
     0x0044, 0x9045, 0x6045, 0xf044, 0xc046, 0x5047, 0xa047, 0x3046,
     0xc043, 0x5042, 0xa042, 0x3043, 0x0041, 0x9040, 0x6040, 0xf041},
    {0x0000, 0xc051, 0xc0a1, 0x00f0, 0xc141, 0x0110, 0x01e0, 0xc1b1,
     0xc281, 0x02d0, 0x0220, 0xc271, 0x03c0, 0xc391, 0xc361, 0x0330,
     0xc501, 0x0550, 0x05a0, 0xc5f1, 0x0440, 0xc411, 0xc4e1, 0x04b0,
     0x0780, 0xc7d1, 0xc721, 0x0770, 0xc6c1, 0x0690, 0x0660, 0xc631,
     0xca01, 0x0a50, 0x0aa0, 0xcaf1, 0x0b40, 0xcb11, 0xcbe1, 0x0bb0,
     0x0880, 0xc8d1, 0xc821, 0x0870, 0xc9c1, 0x0990, 0x0960, 0xc931,
     0x0f00, 0xcf51, 0xcfa1, 0x0ff0, 0xce41, 0x0e10, 0x0ee0, 0xceb1,
     0xcd81, 0x0dd0, 0x0d20, 0xcd71, 0x0cc0, 0xcc91, 0xcc61, 0x0c30,
     0xd401, 0x1450, 0x14a0, 0xd4f1, 0x1540, 0xd511, 0xd5e1, 0x15b0,
     0x1680, 0xd6d1, 0xd621, 0x1670, 0xd7c1, 0x1790, 0x1760, 0xd731,
     0x1100, 0xd151, 0xd1a1, 0x11f0, 0xd041, 0x1010, 0x10e0, 0xd0b1,
     0xd381, 0x13d0, 0x1320, 0xd371, 0x12c0, 0xd291, 0xd261, 0x1230,
     0x1e00, 0xde51, 0xdea1, 0x1ef0, 0xdf41, 0x1f10, 0x1fe0, 0xdfb1,
     0xdc81, 0x1cd0, 0x1c20, 0xdc71, 0x1dc0, 0xdd91, 0xdd61, 0x1d30,
     0xdb01, 0x1b50, 0x1ba0, 0xdbf1, 0x1a40, 0xda11, 0xdae1, 0x1ab0,
     0x1980, 0xd9d1, 0xd921, 0x1970, 0xd8c1, 0x1890, 0x1860, 0xd831,
     0xe801, 0x2850, 0x28a0, 0xe8f1, 0x2940, 0xe911, 0xe9e1, 0x29b0,
     0x2a80, 0xead1, 0xea21, 0x2a70, 0xebc1, 0x2b90, 0x2b60, 0xeb31,
     0x2d00, 0xed51, 0xeda1, 0x2df0, 0xec41, 0x2c10, 0x2ce0, 0xecb1,
     0xef81, 0x2fd0, 0x2f20, 0xef71, 0x2ec0, 0xee91, 0xee61, 0x2e30,
     0x2200, 0xe251, 0xe2a1, 0x22f0, 0xe341, 0x2310, 0x23e0, 0xe3b1,
     0xe081, 0x20d0, 0x2020, 0xe071, 0x21c0, 0xe191, 0xe161, 0x2130,
     0xe701, 0x2750, 0x27a0, 0xe7f1, 0x2640, 0xe611, 0xe6e1, 0x26b0,
     0x2580, 0xe5d1, 0xe521, 0x2570, 0xe4c1, 0x2490, 0x2460, 0xe431,
     0x3c00, 0xfc51, 0xfca1, 0x3cf0, 0xfd41, 0x3d10, 0x3de0, 0xfdb1,
     0xfe81, 0x3ed0, 0x3e20, 0xfe71, 0x3fc0, 0xff91, 0xff61, 0x3f30,
     0xf901, 0x3950, 0x39a0, 0xf9f1, 0x3840, 0xf811, 0xf8e1, 0x38b0,
     0x3b80, 0xfbd1, 0xfb21, 0x3b70, 0xfac1, 0x3a90, 0x3a60, 0xfa31,
     0xf601, 0x3650, 0x36a0, 0xf6f1, 0x3740, 0xf711, 0xf7e1, 0x37b0,
     0x3480, 0xf4d1, 0xf421, 0x3470, 0xf5c1, 0x3590, 0x3560, 0xf531,
     0x3300, 0xf351, 0xf3a1, 0x33f0, 0xf241, 0x3210, 0x32e0, 0xf2b1,
     0xf181, 0x31d0, 0x3120, 0xf171, 0x30c0, 0xf091, 0xf061, 0x3030},
    {0x0000, 0xfc01, 0xb801, 0x4400, 0x3001, 0xcc00, 0x8800, 0x7401,
     0x6002, 0x9c03, 0xd803, 0x2402, 0x5003, 0xac02, 0xe802, 0x1403,
     0xc004, 0x3c05, 0x7805, 0x8404, 0xf005, 0x0c04, 0x4804, 0xb405,
     0xa006, 0x5c07, 0x1807, 0xe406, 0x9007, 0x6c06, 0x2806, 0xd407,
     0xc00b, 0x3c0a, 0x780a, 0x840b, 0xf00a, 0x0c0b, 0x480b, 0xb40a,
     0xa009, 0x5c08, 0x1808, 0xe409, 0x9008, 0x6c09, 0x2809, 0xd408,
     0x000f, 0xfc0e, 0xb80e, 0x440f, 0x300e, 0xcc0f, 0x880f, 0x740e,
     0x600d, 0x9c0c, 0xd80c, 0x240d, 0x500c, 0xac0d, 0xe80d, 0x140c,
     0xc015, 0x3c14, 0x7814, 0x8415, 0xf014, 0x0c15, 0x4815, 0xb414,
     0xa017, 0x5c16, 0x1816, 0xe417, 0x9016, 0x6c17, 0x2817, 0xd416,
     0x0011, 0xfc10, 0xb810, 0x4411, 0x3010, 0xcc11, 0x8811, 0x7410,
     0x6013, 0x9c12, 0xd812, 0x2413, 0x5012, 0xac13, 0xe813, 0x1412,
     0x001e, 0xfc1f, 0xb81f, 0x441e, 0x301f, 0xcc1e, 0x881e, 0x741f,
     0x601c, 0x9c1d, 0xd81d, 0x241c, 0x501d, 0xac1c, 0xe81c, 0x141d,
     0xc01a, 0x3c1b, 0x781b, 0x841a, 0xf01b, 0x0c1a, 0x481a, 0xb41b,
     0xa018, 0x5c19, 0x1819, 0xe418, 0x9019, 0x6c18, 0x2818, 0xd419,
     0xc029, 0x3c28, 0x7828, 0x8429, 0xf028, 0x0c29, 0x4829, 0xb428,
     0xa02b, 0x5c2a, 0x182a, 0xe42b, 0x902a, 0x6c2b, 0x282b, 0xd42a,
     0x002d, 0xfc2c, 0xb82c, 0x442d, 0x302c, 0xcc2d, 0x882d, 0x742c,
     0x602f, 0x9c2e, 0xd82e, 0x242f, 0x502e, 0xac2f, 0xe82f, 0x142e,
     0x0022, 0xfc23, 0xb823, 0x4422, 0x3023, 0xcc22, 0x8822, 0x7423,
     0x6020, 0x9c21, 0xd821, 0x2420, 0x5021, 0xac20, 0xe820, 0x1421,
     0xc026, 0x3c27, 0x7827, 0x8426, 0xf027, 0x0c26, 0x4826, 0xb427,
     0xa024, 0x5c25, 0x1825, 0xe424, 0x9025, 0x6c24, 0x2824, 0xd425,
     0x003c, 0xfc3d, 0xb83d, 0x443c, 0x303d, 0xcc3c, 0x883c, 0x743d,
     0x603e, 0x9c3f, 0xd83f, 0x243e, 0x503f, 0xac3e, 0xe83e, 0x143f,
     0xc038, 0x3c39, 0x7839, 0x8438, 0xf039, 0x0c38, 0x4838, 0xb439,
     0xa03a, 0x5c3b, 0x183b, 0xe43a, 0x903b, 0x6c3a, 0x283a, 0xd43b,
     0xc037, 0x3c36, 0x7836, 0x8437, 0xf036, 0x0c37, 0x4837, 0xb436,
     0xa035, 0x5c34, 0x1834, 0xe435, 0x9034, 0x6c35, 0x2835, 0xd434,
     0x0033, 0xfc32, 0xb832, 0x4433, 0x3032, 0xcc33, 0x8833, 0x7432,
     0x6031, 0x9c30, 0xd830, 0x2431, 0x5030, 0xac31, 0xe831, 0x1430},
    {0x0000, 0xc03d, 0xc079, 0x0044, 0xc0f1, 0x00cc, 0x0088, 0xc0b5,
     0xc1e1, 0x01dc, 0x0198, 0xc1a5, 0x0110, 0xc12d, 0xc169, 0x0154,
     0xc3c1, 0x03fc, 0x03b8, 0xc385, 0x0330, 0xc30d, 0xc349, 0x0374,
     0x0220, 0xc21d, 0xc259, 0x0264, 0xc2d1, 0x02ec, 0x02a8, 0xc295,
     0xc781, 0x07bc, 0x07f8, 0xc7c5, 0x0770, 0xc74d, 0xc709, 0x0734,
     0x0660, 0xc65d, 0xc619, 0x0624, 0xc691, 0x06ac, 0x06e8, 0xc6d5,
     0x0440, 0xc47d, 0xc439, 0x0404, 0xc4b1, 0x048c, 0x04c8, 0xc4f5,
     0xc5a1, 0x059c, 0x05d8, 0xc5e5, 0x0550, 0xc56d, 0xc529, 0x0514,
     0xcf01, 0x0f3c, 0x0f78, 0xcf45, 0x0ff0, 0xcfcd, 0xcf89, 0x0fb4,
     0x0ee0, 0xcedd, 0xce99, 0x0ea4, 0xce11, 0x0e2c, 0x0e68, 0xce55,
     0x0cc0, 0xccfd, 0xccb9, 0x0c84, 0xcc31, 0x0c0c, 0x0c48, 0xcc75,
     0xcd21, 0x0d1c, 0x0d58, 0xcd65, 0x0dd0, 0xcded, 0xcda9, 0x0d94,
     0x0880, 0xc8bd, 0xc8f9, 0x08c4, 0xc871, 0x084c, 0x0808, 0xc835,
     0xc961, 0x095c, 0x0918, 0xc925, 0x0990, 0xc9ad, 0xc9e9, 0x09d4,
     0xcb41, 0x0b7c, 0x0b38, 0xcb05, 0x0bb0, 0xcb8d, 0xcbc9, 0x0bf4,
     0x0aa0, 0xca9d, 0xcad9, 0x0ae4, 0xca51, 0x0a6c, 0x0a28, 0xca15,
     0xde01, 0x1e3c, 0x1e78, 0xde45, 0x1ef0, 0xdecd, 0xde89, 0x1eb4,
     0x1fe0, 0xdfdd, 0xdf99, 0x1fa4, 0xdf11, 0x1f2c, 0x1f68, 0xdf55,
     0x1dc0, 0xddfd, 0xddb9, 0x1d84, 0xdd31, 0x1d0c, 0x1d48, 0xdd75,
     0xdc21, 0x1c1c, 0x1c58, 0xdc65, 0x1cd0, 0xdced, 0xdca9, 0x1c94,
     0x1980, 0xd9bd, 0xd9f9, 0x19c4, 0xd971, 0x194c, 0x1908, 0xd935,
     0xd861, 0x185c, 0x1818, 0xd825, 0x1890, 0xd8ad, 0xd8e9, 0x18d4,
     0xda41, 0x1a7c, 0x1a38, 0xda05, 0x1ab0, 0xda8d, 0xdac9, 0x1af4,
     0x1ba0, 0xdb9d, 0xdbd9, 0x1be4, 0xdb51, 0x1b6c, 0x1b28, 0xdb15,
     0x1100, 0xd13d, 0xd179, 0x1144, 0xd1f1, 0x11cc, 0x1188, 0xd1b5,
     0xd0e1, 0x10dc, 0x1098, 0xd0a5, 0x1010, 0xd02d, 0xd069, 0x1054,
     0xd2c1, 0x12fc, 0x12b8, 0xd285, 0x1230, 0xd20d, 0xd249, 0x1274,
     0x1320, 0xd31d, 0xd359, 0x1364, 0xd3d1, 0x13ec, 0x13a8, 0xd395,
     0xd681, 0x16bc, 0x16f8, 0xd6c5, 0x1670, 0xd64d, 0xd609, 0x1634,
     0x1760, 0xd75d, 0xd719, 0x1724, 0xd791, 0x17ac, 0x17e8, 0xd7d5,
     0x1540, 0xd57d, 0xd539, 0x1504, 0xd5b1, 0x158c, 0x15c8, 0xd5f5,
     0xd4a1, 0x149c, 0x14d8, 0xd4e5, 0x1450, 0xd46d, 0xd429, 0x1414},
    {0x0000, 0xd101, 0xe201, 0x3300, 0x8401, 0x5500, 0x6600, 0xb701,
     0x4801, 0x9900, 0xaa00, 0x7b01, 0xcc00, 0x1d01, 0x2e01, 0xff00,
     0x9002, 0x4103, 0x7203, 0xa302, 0x1403, 0xc502, 0xf602, 0x2703,
     0xd803, 0x0902, 0x3a02, 0xeb03, 0x5c02, 0x8d03, 0xbe03, 0x6f02,
     0x6007, 0xb106, 0x8206, 0x5307, 0xe406, 0x3507, 0x0607, 0xd706,
     0x2806, 0xf907, 0xca07, 0x1b06, 0xac07, 0x7d06, 0x4e06, 0x9f07,
     0xf005, 0x2104, 0x1204, 0xc305, 0x7404, 0xa505, 0x9605, 0x4704,
     0xb804, 0x6905, 0x5a05, 0x8b04, 0x3c05, 0xed04, 0xde04, 0x0f05,
     0xc00e, 0x110f, 0x220f, 0xf30e, 0x440f, 0x950e, 0xa60e, 0x770f,
     0x880f, 0x590e, 0x6a0e, 0xbb0f, 0x0c0e, 0xdd0f, 0xee0f, 0x3f0e,
     0x500c, 0x810d, 0xb20d, 0x630c, 0xd40d, 0x050c, 0x360c, 0xe70d,
     0x180d, 0xc90c, 0xfa0c, 0x2b0d, 0x9c0c, 0x4d0d, 0x7e0d, 0xaf0c,
     0xa009, 0x7108, 0x4208, 0x9309, 0x2408, 0xf509, 0xc609, 0x1708,
     0xe808, 0x3909, 0x0a09, 0xdb08, 0x6c09, 0xbd08, 0x8e08, 0x5f09,
     0x300b, 0xe10a, 0xd20a, 0x030b, 0xb40a, 0x650b, 0x560b, 0x870a,
     0x780a, 0xa90b, 0x9a0b, 0x4b0a, 0xfc0b, 0x2d0a, 0x1e0a, 0xcf0b,
     0xc01f, 0x111e, 0x221e, 0xf31f, 0x441e, 0x951f, 0xa61f, 0x771e,
     0x881e, 0x591f, 0x6a1f, 0xbb1e, 0x0c1f, 0xdd1e, 0xee1e, 0x3f1f,
     0x501d, 0x811c, 0xb21c, 0x631d, 0xd41c, 0x051d, 0x361d, 0xe71c,
     0x181c, 0xc91d, 0xfa1d, 0x2b1c, 0x9c1d, 0x4d1c, 0x7e1c, 0xaf1d,
     0xa018, 0x7119, 0x4219, 0x9318, 0x2419, 0xf518, 0xc618, 0x1719,
     0xe819, 0x3918, 0x0a18, 0xdb19, 0x6c18, 0xbd19, 0x8e19, 0x5f18,
     0x301a, 0xe11b, 0xd21b, 0x031a, 0xb41b, 0x651a, 0x561a, 0x871b,
     0x781b, 0xa91a, 0x9a1a, 0x4b1b, 0xfc1a, 0x2d1b, 0x1e1b, 0xcf1a,
     0x0011, 0xd110, 0xe210, 0x3311, 0x8410, 0x5511, 0x6611, 0xb710,
     0x4810, 0x9911, 0xaa11, 0x7b10, 0xcc11, 0x1d10, 0x2e10, 0xff11,
     0x9013, 0x4112, 0x7212, 0xa313, 0x1412, 0xc513, 0xf613, 0x2712,
     0xd812, 0x0913, 0x3a13, 0xeb12, 0x5c13, 0x8d12, 0xbe12, 0x6f13,
     0x6016, 0xb117, 0x8217, 0x5316, 0xe417, 0x3516, 0x0616, 0xd717,
     0x2817, 0xf916, 0xca16, 0x1b17, 0xac16, 0x7d17, 0x4e17, 0x9f16,
     0xf014, 0x2115, 0x1215, 0xc314, 0x7415, 0xa514, 0x9614, 0x4715,
     0xb815, 0x6914, 0x5a14, 0x8b15, 0x3c14, 0xed15, 0xde15, 0x0f14},
    {0x0000, 0xc010, 0xc023, 0x0033, 0xc045, 0x0055, 0x0066, 0xc076,
     0xc089, 0x0099, 0x00aa, 0xc0ba, 0x00cc, 0xc0dc, 0xc0ef, 0x00ff,
     0xc111, 0x0101, 0x0132, 0xc122, 0x0154, 0xc144, 0xc177, 0x0167,
     0x0198, 0xc188, 0xc1bb, 0x01ab, 0xc1dd, 0x01cd, 0x01fe, 0xc1ee,
     0xc221, 0x0231, 0x0202, 0xc212, 0x0264, 0xc274, 0xc247, 0x0257,
     0x02a8, 0xc2b8, 0xc28b, 0x029b, 0xc2ed, 0x02fd, 0x02ce, 0xc2de,
     0x0330, 0xc320, 0xc313, 0x0303, 0xc375, 0x0365, 0x0356, 0xc346,
     0xc3b9, 0x03a9, 0x039a, 0xc38a, 0x03fc, 0xc3ec, 0xc3df, 0x03cf,
     0xc441, 0x0451, 0x0462, 0xc472, 0x0404, 0xc414, 0xc427, 0x0437,
     0x04c8, 0xc4d8, 0xc4eb, 0x04fb, 0xc48d, 0x049d, 0x04ae, 0xc4be,
     0x0550, 0xc540, 0xc573, 0x0563, 0xc515, 0x0505, 0x0536, 0xc526,
     0xc5d9, 0x05c9, 0x05fa, 0xc5ea, 0x059c, 0xc58c, 0xc5bf, 0x05af,
     0x0660, 0xc670, 0xc643, 0x0653, 0xc625, 0x0635, 0x0606, 0xc616,
     0xc6e9, 0x06f9, 0x06ca, 0xc6da, 0x06ac, 0xc6bc, 0xc68f, 0x069f,
     0xc771, 0x0761, 0x0752, 0xc742, 0x0734, 0xc724, 0xc717, 0x0707,
     0x07f8, 0xc7e8, 0xc7db, 0x07cb, 0xc7bd, 0x07ad, 0x079e, 0xc78e,
     0xc881, 0x0891, 0x08a2, 0xc8b2, 0x08c4, 0xc8d4, 0xc8e7, 0x08f7,
     0x0808, 0xc818, 0xc82b, 0x083b, 0xc84d, 0x085d, 0x086e, 0xc87e,
     0x0990, 0xc980, 0xc9b3, 0x09a3, 0xc9d5, 0x09c5, 0x09f6, 0xc9e6,
     0xc919, 0x0909, 0x093a, 0xc92a, 0x095c, 0xc94c, 0xc97f, 0x096f,
     0x0aa0, 0xcab0, 0xca83, 0x0a93, 0xcae5, 0x0af5, 0x0ac6, 0xcad6,
     0xca29, 0x0a39, 0x0a0a, 0xca1a, 0x0a6c, 0xca7c, 0xca4f, 0x0a5f,
     0xcbb1, 0x0ba1, 0x0b92, 0xcb82, 0x0bf4, 0xcbe4, 0xcbd7, 0x0bc7,
     0x0b38, 0xcb28, 0xcb1b, 0x0b0b, 0xcb7d, 0x0b6d, 0x0b5e, 0xcb4e,
     0x0cc0, 0xccd0, 0xcce3, 0x0cf3, 0xcc85, 0x0c95, 0x0ca6, 0xccb6,
     0xcc49, 0x0c59, 0x0c6a, 0xcc7a, 0x0c0c, 0xcc1c, 0xcc2f, 0x0c3f,
     0xcdd1, 0x0dc1, 0x0df2, 0xcde2, 0x0d94, 0xcd84, 0xcdb7, 0x0da7,
     0x0d58, 0xcd48, 0xcd7b, 0x0d6b, 0xcd1d, 0x0d0d, 0x0d3e, 0xcd2e,
     0xcee1, 0x0ef1, 0x0ec2, 0xced2, 0x0ea4, 0xceb4, 0xce87, 0x0e97,
     0x0e68, 0xce78, 0xce4b, 0x0e5b, 0xce2d, 0x0e3d, 0x0e0e, 0xce1e,
     0x0ff0, 0xcfe0, 0xcfd3, 0x0fc3, 0xcfb5, 0x0fa5, 0x0f96, 0xcf86,
     0xcf79, 0x0f69, 0x0f5a, 0xcf4a, 0x0f3c, 0xcf2c, 0xcf1f, 0x0f0f},
    {0x0000, 0xccc1, 0xd981, 0x1540, 0xf301, 0x3fc0, 0x2a80, 0xe641,
     0xa601, 0x6ac0, 0x7f80, 0xb341, 0x5500, 0x99c1, 0x8c81, 0x4040,
     0x0c01, 0xc0c0, 0xd580, 0x1941, 0xff00, 0x33c1, 0x2681, 0xea40,
     0xaa00, 0x66c1, 0x7381, 0xbf40, 0x5901, 0x95c0, 0x8080, 0x4c41,
     0x1802, 0xd4c3, 0xc183, 0x0d42, 0xeb03, 0x27c2, 0x3282, 0xfe43,
     0xbe03, 0x72c2, 0x6782, 0xab43, 0x4d02, 0x81c3, 0x9483, 0x5842,
     0x1403, 0xd8c2, 0xcd82, 0x0143, 0xe702, 0x2bc3, 0x3e83, 0xf242,
     0xb202, 0x7ec3, 0x6b83, 0xa742, 0x4103, 0x8dc2, 0x9882, 0x5443,
     0x3004, 0xfcc5, 0xe985, 0x2544, 0xc305, 0x0fc4, 0x1a84, 0xd645,
     0x9605, 0x5ac4, 0x4f84, 0x8345, 0x6504, 0xa9c5, 0xbc85, 0x7044,
     0x3c05, 0xf0c4, 0xe584, 0x2945, 0xcf04, 0x03c5, 0x1685, 0xda44,
     0x9a04, 0x56c5, 0x4385, 0x8f44, 0x6905, 0xa5c4, 0xb084, 0x7c45,
     0x2806, 0xe4c7, 0xf187, 0x3d46, 0xdb07, 0x17c6, 0x0286, 0xce47,
     0x8e07, 0x42c6, 0x5786, 0x9b47, 0x7d06, 0xb1c7, 0xa487, 0x6846,
     0x2407, 0xe8c6, 0xfd86, 0x3147, 0xd706, 0x1bc7, 0x0e87, 0xc246,
     0x8206, 0x4ec7, 0x5b87, 0x9746, 0x7107, 0xbdc6, 0xa886, 0x6447,
     0x6008, 0xacc9, 0xb989, 0x7548, 0x9309, 0x5fc8, 0x4a88, 0x8649,
     0xc609, 0x0ac8, 0x1f88, 0xd349, 0x3508, 0xf9c9, 0xec89, 0x2048,
     0x6c09, 0xa0c8, 0xb588, 0x7949, 0x9f08, 0x53c9, 0x4689, 0x8a48,
     0xca08, 0x06c9, 0x1389, 0xdf48, 0x3909, 0xf5c8, 0xe088, 0x2c49,
     0x780a, 0xb4cb, 0xa18b, 0x6d4a, 0x8b0b, 0x47ca, 0x528a, 0x9e4b,
     0xde0b, 0x12ca, 0x078a, 0xcb4b, 0x2d0a, 0xe1cb, 0xf48b, 0x384a,
     0x740b, 0xb8ca, 0xad8a, 0x614b, 0x870a, 0x4bcb, 0x5e8b, 0x924a,
     0xd20a, 0x1ecb, 0x0b8b, 0xc74a, 0x210b, 0xedca, 0xf88a, 0x344b,
     0x500c, 0x9ccd, 0x898d, 0x454c, 0xa30d, 0x6fcc, 0x7a8c, 0xb64d,
     0xf60d, 0x3acc, 0x2f8c, 0xe34d, 0x050c, 0xc9cd, 0xdc8d, 0x104c,
     0x5c0d, 0x90cc, 0x858c, 0x494d, 0xaf0c, 0x63cd, 0x768d, 0xba4c,
     0xfa0c, 0x36cd, 0x238d, 0xef4c, 0x090d, 0xc5cc, 0xd08c, 0x1c4d,
     0x480e, 0x84cf, 0x918f, 0x5d4e, 0xbb0f, 0x77ce, 0x628e, 0xae4f,
     0xee0f, 0x22ce, 0x378e, 0xfb4f, 0x1d0e, 0xd1cf, 0xc48f, 0x084e,
     0x440f, 0x88ce, 0x9d8e, 0x514f, 0xb70e, 0x7bcf, 0x6e8f, 0xa24e,
     0xe20e, 0x2ecf, 0x3b8f, 0xf74e, 0x110f, 0xddce, 0xc88e, 0x044f},
    {0x0000, 0x900d, 0x6019, 0xf014, 0xc032, 0x503f, 0xa02b, 0x3026,
     0xc067, 0x506a, 0xa07e, 0x3073, 0x0055, 0x9058, 0x604c, 0xf041,
     0xc0cd, 0x50c0, 0xa0d4, 0x30d9, 0x00ff, 0x90f2, 0x60e6, 0xf0eb,
     0x00aa, 0x90a7, 0x60b3, 0xf0be, 0xc098, 0x5095, 0xa081, 0x308c,
     0xc199, 0x5194, 0xa180, 0x318d, 0x01ab, 0x91a6, 0x61b2, 0xf1bf,
     0x01fe, 0x91f3, 0x61e7, 0xf1ea, 0xc1cc, 0x51c1, 0xa1d5, 0x31d8,
     0x0154, 0x9159, 0x614d, 0xf140, 0xc166, 0x516b, 0xa17f, 0x3172,
     0xc133, 0x513e, 0xa12a, 0x3127, 0x0101, 0x910c, 0x6118, 0xf115,
     0xc331, 0x533c, 0xa328, 0x3325, 0x0303, 0x930e, 0x631a, 0xf317,
     0x0356, 0x935b, 0x634f, 0xf342, 0xc364, 0x5369, 0xa37d, 0x3370,
     0x03fc, 0x93f1, 0x63e5, 0xf3e8, 0xc3ce, 0x53c3, 0xa3d7, 0x33da,
     0xc39b, 0x5396, 0xa382, 0x338f, 0x03a9, 0x93a4, 0x63b0, 0xf3bd,
     0x02a8, 0x92a5, 0x62b1, 0xf2bc, 0xc29a, 0x5297, 0xa283, 0x328e,
     0xc2cf, 0x52c2, 0xa2d6, 0x32db, 0x02fd, 0x92f0, 0x62e4, 0xf2e9,
     0xc265, 0x5268, 0xa27c, 0x3271, 0x0257, 0x925a, 0x624e, 0xf243,
     0x0202, 0x920f, 0x621b, 0xf216, 0xc230, 0x523d, 0xa229, 0x3224,
     0xc661, 0x566c, 0xa678, 0x3675, 0x0653, 0x965e, 0x664a, 0xf647,
     0x0606, 0x960b, 0x661f, 0xf612, 0xc634, 0x5639, 0xa62d, 0x3620,
     0x06ac, 0x96a1, 0x66b5, 0xf6b8, 0xc69e, 0x5693, 0xa687, 0x368a,
     0xc6cb, 0x56c6, 0xa6d2, 0x36df, 0x06f9, 0x96f4, 0x66e0, 0xf6ed,
     0x07f8, 0x97f5, 0x67e1, 0xf7ec, 0xc7ca, 0x57c7, 0xa7d3, 0x37de,
     0xc79f, 0x5792, 0xa786, 0x378b, 0x07ad, 0x97a0, 0x67b4, 0xf7b9,
     0xc735, 0x5738, 0xa72c, 0x3721, 0x0707, 0x970a, 0x671e, 0xf713,
     0x0752, 0x975f, 0x674b, 0xf746, 0xc760, 0x576d, 0xa779, 0x3774,
     0x0550, 0x955d, 0x6549, 0xf544, 0xc562, 0x556f, 0xa57b, 0x3576,
     0xc537, 0x553a, 0xa52e, 0x3523, 0x0505, 0x9508, 0x651c, 0xf511,
     0xc59d, 0x5590, 0xa584, 0x3589, 0x05af, 0x95a2, 0x65b6, 0xf5bb,
     0x05fa, 0x95f7, 0x65e3, 0xf5ee, 0xc5c8, 0x55c5, 0xa5d1, 0x35dc,
     0xc4c9, 0x54c4, 0xa4d0, 0x34dd, 0x04fb, 0x94f6, 0x64e2, 0xf4ef,
     0x04ae, 0x94a3, 0x64b7, 0xf4ba, 0xc49c, 0x5491, 0xa485, 0x3488,
     0x0404, 0x9409, 0x641d, 0xf410, 0xc436, 0x543b, 0xa42f, 0x3422,
     0xc463, 0x546e, 0xa47a, 0x3477, 0x0451, 0x945c, 0x6448, 0xf445},
    {0x0000, 0xc551, 0xcaa1, 0x0ff0, 0xd541, 0x1010, 0x1fe0, 0xdab1,
     0xea81, 0x2fd0, 0x2020, 0xe571, 0x3fc0, 0xfa91, 0xf561, 0x3030,
     0x9501, 0x5050, 0x5fa0, 0x9af1, 0x4040, 0x8511, 0x8ae1, 0x4fb0,
     0x7f80, 0xbad1, 0xb521, 0x7070, 0xaac1, 0x6f90, 0x6060, 0xa531,
     0x6a01, 0xaf50, 0xa0a0, 0x65f1, 0xbf40, 0x7a11, 0x75e1, 0xb0b0,
     0x8080, 0x45d1, 0x4a21, 0x8f70, 0x55c1, 0x9090, 0x9f60, 0x5a31,
     0xff00, 0x3a51, 0x35a1, 0xf0f0, 0x2a41, 0xef10, 0xe0e0, 0x25b1,
     0x1581, 0xd0d0, 0xdf20, 0x1a71, 0xc0c0, 0x0591, 0x0a61, 0xcf30,
     0xd402, 0x1153, 0x1ea3, 0xdbf2, 0x0143, 0xc412, 0xcbe2, 0x0eb3,
     0x3e83, 0xfbd2, 0xf422, 0x3173, 0xebc2, 0x2e93, 0x2163, 0xe432,
     0x4103, 0x8452, 0x8ba2, 0x4ef3, 0x9442, 0x5113, 0x5ee3, 0x9bb2,
     0xab82, 0x6ed3, 0x6123, 0xa472, 0x7ec3, 0xbb92, 0xb462, 0x7133,
     0xbe03, 0x7b52, 0x74a2, 0xb1f3, 0x6b42, 0xae13, 0xa1e3, 0x64b2,
     0x5482, 0x91d3, 0x9e23, 0x5b72, 0x81c3, 0x4492, 0x4b62, 0x8e33,
     0x2b02, 0xee53, 0xe1a3, 0x24f2, 0xfe43, 0x3b12, 0x34e2, 0xf1b3,
     0xc183, 0x04d2, 0x0b22, 0xce73, 0x14c2, 0xd193, 0xde63, 0x1b32,
     0xe807, 0x2d56, 0x22a6, 0xe7f7, 0x3d46, 0xf817, 0xf7e7, 0x32b6,
     0x0286, 0xc7d7, 0xc827, 0x0d76, 0xd7c7, 0x1296, 0x1d66, 0xd837,
     0x7d06, 0xb857, 0xb7a7, 0x72f6, 0xa847, 0x6d16, 0x62e6, 0xa7b7,
     0x9787, 0x52d6, 0x5d26, 0x9877, 0x42c6, 0x8797, 0x8867, 0x4d36,
     0x8206, 0x4757, 0x48a7, 0x8df6, 0x5747, 0x9216, 0x9de6, 0x58b7,
     0x6887, 0xadd6, 0xa226, 0x6777, 0xbdc6, 0x7897, 0x7767, 0xb236,
     0x1707, 0xd256, 0xdda6, 0x18f7, 0xc246, 0x0717, 0x08e7, 0xcdb6,
     0xfd86, 0x38d7, 0x3727, 0xf276, 0x28c7, 0xed96, 0xe266, 0x2737,
     0x3c05, 0xf954, 0xf6a4, 0x33f5, 0xe944, 0x2c15, 0x23e5, 0xe6b4,
     0xd684, 0x13d5, 0x1c25, 0xd974, 0x03c5, 0xc694, 0xc964, 0x0c35,
     0xa904, 0x6c55, 0x63a5, 0xa6f4, 0x7c45, 0xb914, 0xb6e4, 0x73b5,
     0x4385, 0x86d4, 0x8924, 0x4c75, 0x96c4, 0x5395, 0x5c65, 0x9934,
     0x5604, 0x9355, 0x9ca5, 0x59f4, 0x8345, 0x4614, 0x49e4, 0x8cb5,
     0xbc85, 0x79d4, 0x7624, 0xb375, 0x69c4, 0xac95, 0xa365, 0x6634,
     0xc305, 0x0654, 0x09a4, 0xccf5, 0x1644, 0xd315, 0xdce5, 0x19b4,
     0x2984, 0xecd5, 0xe325, 0x2674, 0xfcc5, 0x3994, 0x3664, 0xf335},
    {0x0000, 0xfc04, 0xb80b, 0x440f, 0x3015, 0xcc11, 0x881e, 0x741a,
     0x602a, 0x9c2e, 0xd821, 0x2425, 0x503f, 0xac3b, 0xe834, 0x1430,
     0xc054, 0x3c50, 0x785f, 0x845b, 0xf041, 0x0c45, 0x484a, 0xb44e,
     0xa07e, 0x5c7a, 0x1875, 0xe471, 0x906b, 0x6c6f, 0x2860, 0xd464,
     0xc0ab, 0x3caf, 0x78a0, 0x84a4, 0xf0be, 0x0cba, 0x48b5, 0xb4b1,
     0xa081, 0x5c85, 0x188a, 0xe48e, 0x9094, 0x6c90, 0x289f, 0xd49b,
     0x00ff, 0xfcfb, 0xb8f4, 0x44f0, 0x30ea, 0xccee, 0x88e1, 0x74e5,
     0x60d5, 0x9cd1, 0xd8de, 0x24da, 0x50c0, 0xacc4, 0xe8cb, 0x14cf,
     0xc155, 0x3d51, 0x795e, 0x855a, 0xf140, 0x0d44, 0x494b, 0xb54f,
     0xa17f, 0x5d7b, 0x1974, 0xe570, 0x916a, 0x6d6e, 0x2961, 0xd565,
     0x0101, 0xfd05, 0xb90a, 0x450e, 0x3114, 0xcd10, 0x891f, 0x751b,
     0x612b, 0x9d2f, 0xd920, 0x2524, 0x513e, 0xad3a, 0xe935, 0x1531,
     0x01fe, 0xfdfa, 0xb9f5, 0x45f1, 0x31eb, 0xcdef, 0x89e0, 0x75e4,
     0x61d4, 0x9dd0, 0xd9df, 0x25db, 0x51c1, 0xadc5, 0xe9ca, 0x15ce,
     0xc1aa, 0x3dae, 0x79a1, 0x85a5, 0xf1bf, 0x0dbb, 0x49b4, 0xb5b0,
     0xa180, 0x5d84, 0x198b, 0xe58f, 0x9195, 0x6d91, 0x299e, 0xd59a,
     0xc2a9, 0x3ead, 0x7aa2, 0x86a6, 0xf2bc, 0x0eb8, 0x4ab7, 0xb6b3,
     0xa283, 0x5e87, 0x1a88, 0xe68c, 0x9296, 0x6e92, 0x2a9d, 0xd699,
     0x02fd, 0xfef9, 0xbaf6, 0x46f2, 0x32e8, 0xceec, 0x8ae3, 0x76e7,
     0x62d7, 0x9ed3, 0xdadc, 0x26d8, 0x52c2, 0xaec6, 0xeac9, 0x16cd,
     0x0202, 0xfe06, 0xba09, 0x460d, 0x3217, 0xce13, 0x8a1c, 0x7618,
     0x6228, 0x9e2c, 0xda23, 0x2627, 0x523d, 0xae39, 0xea36, 0x1632,
     0xc256, 0x3e52, 0x7a5d, 0x8659, 0xf243, 0x0e47, 0x4a48, 0xb64c,
     0xa27c, 0x5e78, 0x1a77, 0xe673, 0x9269, 0x6e6d, 0x2a62, 0xd666,
     0x03fc, 0xfff8, 0xbbf7, 0x47f3, 0x33e9, 0xcfed, 0x8be2, 0x77e6,
     0x63d6, 0x9fd2, 0xdbdd, 0x27d9, 0x53c3, 0xafc7, 0xebc8, 0x17cc,
     0xc3a8, 0x3fac, 0x7ba3, 0x87a7, 0xf3bd, 0x0fb9, 0x4bb6, 0xb7b2,
     0xa382, 0x5f86, 0x1b89, 0xe78d, 0x9397, 0x6f93, 0x2b9c, 0xd798,
     0xc357, 0x3f53, 0x7b5c, 0x8758, 0xf342, 0x0f46, 0x4b49, 0xb74d,
     0xa37d, 0x5f79, 0x1b76, 0xe772, 0x9368, 0x6f6c, 0x2b63, 0xd767,
     0x0303, 0xff07, 0xbb08, 0x470c, 0x3316, 0xcf12, 0x8b1d, 0x7719,
     0x6329, 0x9f2d, 0xdb22, 0x2726, 0x533c, 0xaf38, 0xeb37, 0x1733},
    {0x0000, 0xc3fd, 0xc7f9, 0x0404, 0xcff1, 0x0c0c, 0x0808, 0xcbf5,
     0xdfe1, 0x1c1c, 0x1818, 0xdbe5, 0x1010, 0xd3ed, 0xd7e9, 0x1414,
     0xffc1, 0x3c3c, 0x3838, 0xfbc5, 0x3030, 0xf3cd, 0xf7c9, 0x3434,
     0x2020, 0xe3dd, 0xe7d9, 0x2424, 0xefd1, 0x2c2c, 0x2828, 0xebd5,
     0xbf81, 0x7c7c, 0x7878, 0xbb85, 0x7070, 0xb38d, 0xb789, 0x7474,
     0x6060, 0xa39d, 0xa799, 0x6464, 0xaf91, 0x6c6c, 0x6868, 0xab95,
     0x4040, 0x83bd, 0x87b9, 0x4444, 0x8fb1, 0x4c4c, 0x4848, 0x8bb5,
     0x9fa1, 0x5c5c, 0x5858, 0x9ba5, 0x5050, 0x93ad, 0x97a9, 0x5454,
     0x3f01, 0xfcfc, 0xf8f8, 0x3b05, 0xf0f0, 0x330d, 0x3709, 0xf4f4,
     0xe0e0, 0x231d, 0x2719, 0xe4e4, 0x2f11, 0xecec, 0xe8e8, 0x2b15,
     0xc0c0, 0x033d, 0x0739, 0xc4c4, 0x0f31, 0xcccc, 0xc8c8, 0x0b35,
     0x1f21, 0xdcdc, 0xd8d8, 0x1b25, 0xd0d0, 0x132d, 0x1729, 0xd4d4,
     0x8080, 0x437d, 0x4779, 0x8484, 0x4f71, 0x8c8c, 0x8888, 0x4b75,
     0x5f61, 0x9c9c, 0x9898, 0x5b65, 0x9090, 0x536d, 0x5769, 0x9494,
     0x7f41, 0xbcbc, 0xb8b8, 0x7b45, 0xb0b0, 0x734d, 0x7749, 0xb4b4,
     0xa0a0, 0x635d, 0x6759, 0xa4a4, 0x6f51, 0xacac, 0xa8a8, 0x6b55,
     0x7e02, 0xbdff, 0xb9fb, 0x7a06, 0xb1f3, 0x720e, 0x760a, 0xb5f7,
     0xa1e3, 0x621e, 0x661a, 0xa5e7, 0x6e12, 0xadef, 0xa9eb, 0x6a16,
     0x81c3, 0x423e, 0x463a, 0x85c7, 0x4e32, 0x8dcf, 0x89cb, 0x4a36,
     0x5e22, 0x9ddf, 0x99db, 0x5a26, 0x91d3, 0x522e, 0x562a, 0x95d7,
     0xc183, 0x027e, 0x067a, 0xc587, 0x0e72, 0xcd8f, 0xc98b, 0x0a76,
     0x1e62, 0xdd9f, 0xd99b, 0x1a66, 0xd193, 0x126e, 0x166a, 0xd597,
     0x3e42, 0xfdbf, 0xf9bb, 0x3a46, 0xf1b3, 0x324e, 0x364a, 0xf5b7,
     0xe1a3, 0x225e, 0x265a, 0xe5a7, 0x2e52, 0xedaf, 0xe9ab, 0x2a56,
     0x4103, 0x82fe, 0x86fa, 0x4507, 0x8ef2, 0x4d0f, 0x490b, 0x8af6,
     0x9ee2, 0x5d1f, 0x591b, 0x9ae6, 0x5113, 0x92ee, 0x96ea, 0x5517,
     0xbec2, 0x7d3f, 0x793b, 0xbac6, 0x7133, 0xb2ce, 0xb6ca, 0x7537,
     0x6123, 0xa2de, 0xa6da, 0x6527, 0xaed2, 0x6d2f, 0x692b, 0xaad6,
     0xfe82, 0x3d7f, 0x397b, 0xfa86, 0x3173, 0xf28e, 0xf68a, 0x3577,
     0x2163, 0xe29e, 0xe69a, 0x2567, 0xee92, 0x2d6f, 0x296b, 0xea96,
     0x0143, 0xc2be, 0xc6ba, 0x0547, 0xceb2, 0x0d4f, 0x094b, 0xcab6,
     0xdea2, 0x1d5f, 0x195b, 0xdaa6, 0x1153, 0xd2ae, 0xd6aa, 0x1557},
    {0x0000, 0x8102, 0x4207, 0xc305, 0x840e, 0x050c, 0xc609, 0x470b,
     0x481f, 0xc91d, 0x0a18, 0x8b1a, 0xcc11, 0x4d13, 0x8e16, 0x0f14,
     0x903e, 0x113c, 0xd239, 0x533b, 0x1430, 0x9532, 0x5637, 0xd735,
     0xd821, 0x5923, 0x9a26, 0x1b24, 0x5c2f, 0xdd2d, 0x1e28, 0x9f2a,
     0x607f, 0xe17d, 0x2278, 0xa37a, 0xe471, 0x6573, 0xa676, 0x2774,
     0x2860, 0xa962, 0x6a67, 0xeb65, 0xac6e, 0x2d6c, 0xee69, 0x6f6b,
     0xf041, 0x7143, 0xb246, 0x3344, 0x744f, 0xf54d, 0x3648, 0xb74a,
     0xb85e, 0x395c, 0xfa59, 0x7b5b, 0x3c50, 0xbd52, 0x7e57, 0xff55,
     0xc0fe, 0x41fc, 0x82f9, 0x03fb, 0x44f0, 0xc5f2, 0x06f7, 0x87f5,
     0x88e1, 0x09e3, 0xcae6, 0x4be4, 0x0cef, 0x8ded, 0x4ee8, 0xcfea,
     0x50c0, 0xd1c2, 0x12c7, 0x93c5, 0xd4ce, 0x55cc, 0x96c9, 0x17cb,
     0x18df, 0x99dd, 0x5ad8, 0xdbda, 0x9cd1, 0x1dd3, 0xded6, 0x5fd4,
     0xa081, 0x2183, 0xe286, 0x6384, 0x248f, 0xa58d, 0x6688, 0xe78a,
     0xe89e, 0x699c, 0xaa99, 0x2b9b, 0x6c90, 0xed92, 0x2e97, 0xaf95,
     0x30bf, 0xb1bd, 0x72b8, 0xf3ba, 0xb4b1, 0x35b3, 0xf6b6, 0x77b4,
     0x78a0, 0xf9a2, 0x3aa7, 0xbba5, 0xfcae, 0x7dac, 0xbea9, 0x3fab,
     0xc1ff, 0x40fd, 0x83f8, 0x02fa, 0x45f1, 0xc4f3, 0x07f6, 0x86f4,
     0x89e0, 0x08e2, 0xcbe7, 0x4ae5, 0x0dee, 0x8cec, 0x4fe9, 0xceeb,
     0x51c1, 0xd0c3, 0x13c6, 0x92c4, 0xd5cf, 0x54cd, 0x97c8, 0x16ca,
     0x19de, 0x98dc, 0x5bd9, 0xdadb, 0x9dd0, 0x1cd2, 0xdfd7, 0x5ed5,
     0xa180, 0x2082, 0xe387, 0x6285, 0x258e, 0xa48c, 0x6789, 0xe68b,
     0xe99f, 0x689d, 0xab98, 0x2a9a, 0x6d91, 0xec93, 0x2f96, 0xae94,
     0x31be, 0xb0bc, 0x73b9, 0xf2bb, 0xb5b0, 0x34b2, 0xf7b7, 0x76b5,
     0x79a1, 0xf8a3, 0x3ba6, 0xbaa4, 0xfdaf, 0x7cad, 0xbfa8, 0x3eaa,
     0x0101, 0x8003, 0x4306, 0xc204, 0x850f, 0x040d, 0xc708, 0x460a,
     0x491e, 0xc81c, 0x0b19, 0x8a1b, 0xcd10, 0x4c12, 0x8f17, 0x0e15,
     0x913f, 0x103d, 0xd338, 0x523a, 0x1531, 0x9433, 0x5736, 0xd634,
     0xd920, 0x5822, 0x9b27, 0x1a25, 0x5d2e, 0xdc2c, 0x1f29, 0x9e2b,
     0x617e, 0xe07c, 0x2379, 0xa27b, 0xe570, 0x6472, 0xa777, 0x2675,
     0x2961, 0xa863, 0x6b66, 0xea64, 0xad6f, 0x2c6d, 0xef68, 0x6e6a,
     0xf140, 0x7042, 0xb347, 0x3245, 0x754e, 0xf44c, 0x3749, 0xb64b,
     0xb95f, 0x385d, 0xfb58, 0x7a5a, 0x3d51, 0xbc53, 0x7f56, 0xfe54},
    {0x0000, 0xc100, 0xc203, 0x0303, 0xc405, 0x0505, 0x0606, 0xc706,
     0xc809, 0x0909, 0x0a0a, 0xcb0a, 0x0c0c, 0xcd0c, 0xce0f, 0x0f0f,
     0xd011, 0x1111, 0x1212, 0xd312, 0x1414, 0xd514, 0xd617, 0x1717,
     0x1818, 0xd918, 0xda1b, 0x1b1b, 0xdc1d, 0x1d1d, 0x1e1e, 0xdf1e,
     0xe021, 0x2121, 0x2222, 0xe322, 0x2424, 0xe524, 0xe627, 0x2727,
     0x2828, 0xe928, 0xea2b, 0x2b2b, 0xec2d, 0x2d2d, 0x2e2e, 0xef2e,
     0x3030, 0xf130, 0xf233, 0x3333, 0xf435, 0x3535, 0x3636, 0xf736,
     0xf839, 0x3939, 0x3a3a, 0xfb3a, 0x3c3c, 0xfd3c, 0xfe3f, 0x3f3f,
     0x8041, 0x4141, 0x4242, 0x8342, 0x4444, 0x8544, 0x8647, 0x4747,
     0x4848, 0x8948, 0x8a4b, 0x4b4b, 0x8c4d, 0x4d4d, 0x4e4e, 0x8f4e,
     0x5050, 0x9150, 0x9253, 0x5353, 0x9455, 0x5555, 0x5656, 0x9756,
     0x9859, 0x5959, 0x5a5a, 0x9b5a, 0x5c5c, 0x9d5c, 0x9e5f, 0x5f5f,
     0x6060, 0xa160, 0xa263, 0x6363, 0xa465, 0x6565, 0x6666, 0xa766,
     0xa869, 0x6969, 0x6a6a, 0xab6a, 0x6c6c, 0xad6c, 0xae6f, 0x6f6f,
     0xb071, 0x7171, 0x7272, 0xb372, 0x7474, 0xb574, 0xb677, 0x7777,
     0x7878, 0xb978, 0xba7b, 0x7b7b, 0xbc7d, 0x7d7d, 0x7e7e, 0xbf7e,
     0x4081, 0x8181, 0x8282, 0x4382, 0x8484, 0x4584, 0x4687, 0x8787,
     0x8888, 0x4988, 0x4a8b, 0x8b8b, 0x4c8d, 0x8d8d, 0x8e8e, 0x4f8e,
     0x9090, 0x5190, 0x5293, 0x9393, 0x5495, 0x9595, 0x9696, 0x5796,
     0x5899, 0x9999, 0x9a9a, 0x5b9a, 0x9c9c, 0x5d9c, 0x5e9f, 0x9f9f,
     0xa0a0, 0x61a0, 0x62a3, 0xa3a3, 0x64a5, 0xa5a5, 0xa6a6, 0x67a6,
     0x68a9, 0xa9a9, 0xaaaa, 0x6baa, 0xacac, 0x6dac, 0x6eaf, 0xafaf,
     0x70b1, 0xb1b1, 0xb2b2, 0x73b2, 0xb4b4, 0x75b4, 0x76b7, 0xb7b7,
     0xb8b8, 0x79b8, 0x7abb, 0xbbbb, 0x7cbd, 0xbdbd, 0xbebe, 0x7fbe,
     0xc0c0, 0x01c0, 0x02c3, 0xc3c3, 0x04c5, 0xc5c5, 0xc6c6, 0x07c6,
     0x08c9, 0xc9c9, 0xcaca, 0x0bca, 0xcccc, 0x0dcc, 0x0ecf, 0xcfcf,
     0x10d1, 0xd1d1, 0xd2d2, 0x13d2, 0xd4d4, 0x15d4, 0x16d7, 0xd7d7,
     0xd8d8, 0x19d8, 0x1adb, 0xdbdb, 0x1cdd, 0xdddd, 0xdede, 0x1fde,
     0x20e1, 0xe1e1, 0xe2e2, 0x23e2, 0xe4e4, 0x25e4, 0x26e7, 0xe7e7,
     0xe8e8, 0x29e8, 0x2aeb, 0xebeb, 0x2ced, 0xeded, 0xeeee, 0x2fee,
     0xf0f0, 0x31f0, 0x32f3, 0xf3f3, 0x34f5, 0xf5f5, 0xf6f6, 0x37f6,
     0x38f9, 0xf9f9, 0xfafa, 0x3bfa, 0xfcfc, 0x3dfc, 0x3eff, 0xffff},
    {0x0000, 0x00c1, 0x0182, 0x0143, 0x0304, 0x03c5, 0x0286, 0x0247,
     0x0608, 0x06c9, 0x078a, 0x074b, 0x050c, 0x05cd, 0x048e, 0x044f,
     0x0c10, 0x0cd1, 0x0d92, 0x0d53, 0x0f14, 0x0fd5, 0x0e96, 0x0e57,
     0x0a18, 0x0ad9, 0x0b9a, 0x0b5b, 0x091c, 0x09dd, 0x089e, 0x085f,
     0x1820, 0x18e1, 0x19a2, 0x1963, 0x1b24, 0x1be5, 0x1aa6, 0x1a67,
     0x1e28, 0x1ee9, 0x1faa, 0x1f6b, 0x1d2c, 0x1ded, 0x1cae, 0x1c6f,
     0x1430, 0x14f1, 0x15b2, 0x1573, 0x1734, 0x17f5, 0x16b6, 0x1677,
     0x1238, 0x12f9, 0x13ba, 0x137b, 0x113c, 0x11fd, 0x10be, 0x107f,
     0x3040, 0x3081, 0x31c2, 0x3103, 0x3344, 0x3385, 0x32c6, 0x3207,
     0x3648, 0x3689, 0x37ca, 0x370b, 0x354c, 0x358d, 0x34ce, 0x340f,
     0x3c50, 0x3c91, 0x3dd2, 0x3d13, 0x3f54, 0x3f95, 0x3ed6, 0x3e17,
     0x3a58, 0x3a99, 0x3bda, 0x3b1b, 0x395c, 0x399d, 0x38de, 0x381f,
     0x2860, 0x28a1, 0x29e2, 0x2923, 0x2b64, 0x2ba5, 0x2ae6, 0x2a27,
     0x2e68, 0x2ea9, 0x2fea, 0x2f2b, 0x2d6c, 0x2dad, 0x2cee, 0x2c2f,
     0x2470, 0x24b1, 0x25f2, 0x2533, 0x2774, 0x27b5, 0x26f6, 0x2637,
     0x2278, 0x22b9, 0x23fa, 0x233b, 0x217c, 0x21bd, 0x20fe, 0x203f,
     0x6080, 0x6041, 0x6102, 0x61c3, 0x6384, 0x6345, 0x6206, 0x62c7,
     0x6688, 0x6649, 0x670a, 0x67cb, 0x658c, 0x654d, 0x640e, 0x64cf,
     0x6c90, 0x6c51, 0x6d12, 0x6dd3, 0x6f94, 0x6f55, 0x6e16, 0x6ed7,
     0x6a98, 0x6a59, 0x6b1a, 0x6bdb, 0x699c, 0x695d, 0x681e, 0x68df,
     0x78a0, 0x7861, 0x7922, 0x79e3, 0x7ba4, 0x7b65, 0x7a26, 0x7ae7,
     0x7ea8, 0x7e69, 0x7f2a, 0x7feb, 0x7dac, 0x7d6d, 0x7c2e, 0x7cef,
     0x74b0, 0x7471, 0x7532, 0x75f3, 0x77b4, 0x7775, 0x7636, 0x76f7,
     0x72b8, 0x7279, 0x733a, 0x73fb, 0x71bc, 0x717d, 0x703e, 0x70ff,
     0x50c0, 0x5001, 0x5142, 0x5183, 0x53c4, 0x5305, 0x5246, 0x5287,
     0x56c8, 0x5609, 0x574a, 0x578b, 0x55cc, 0x550d, 0x544e, 0x548f,
     0x5cd0, 0x5c11, 0x5d52, 0x5d93, 0x5fd4, 0x5f15, 0x5e56, 0x5e97,
     0x5ad8, 0x5a19, 0x5b5a, 0x5b9b, 0x59dc, 0x591d, 0x585e, 0x589f,
     0x48e0, 0x4821, 0x4962, 0x49a3, 0x4be4, 0x4b25, 0x4a66, 0x4aa7,
     0x4ee8, 0x4e29, 0x4f6a, 0x4fab, 0x4dec, 0x4d2d, 0x4c6e, 0x4caf,
     0x44f0, 0x4431, 0x4572, 0x45b3, 0x47f4, 0x4735, 0x4676, 0x46b7,
     0x42f8, 0x4239, 0x437a, 0x43bb, 0x41fc, 0x413d, 0x407e, 0x40bf},
    {0x0000, 0x90c1, 0x6181, 0xf140, 0xc302, 0x53c3, 0xa283, 0x3242,
     0xc607, 0x56c6, 0xa786, 0x3747, 0x0505, 0x95c4, 0x6484, 0xf445,
     0xcc0d, 0x5ccc, 0xad8c, 0x3d4d, 0x0f0f, 0x9fce, 0x6e8e, 0xfe4f,
     0x0a0a, 0x9acb, 0x6b8b, 0xfb4a, 0xc908, 0x59c9, 0xa889, 0x3848,
     0xd819, 0x48d8, 0xb998, 0x2959, 0x1b1b, 0x8bda, 0x7a9a, 0xea5b,
     0x1e1e, 0x8edf, 0x7f9f, 0xef5e, 0xdd1c, 0x4ddd, 0xbc9d, 0x2c5c,
     0x1414, 0x84d5, 0x7595, 0xe554, 0xd716, 0x47d7, 0xb697, 0x2656,
     0xd213, 0x42d2, 0xb392, 0x2353, 0x1111, 0x81d0, 0x7090, 0xe051,
     0xf031, 0x60f0, 0x91b0, 0x0171, 0x3333, 0xa3f2, 0x52b2, 0xc273,
     0x3636, 0xa6f7, 0x57b7, 0xc776, 0xf534, 0x65f5, 0x94b5, 0x0474,
     0x3c3c, 0xacfd, 0x5dbd, 0xcd7c, 0xff3e, 0x6fff, 0x9ebf, 0x0e7e,
     0xfa3b, 0x6afa, 0x9bba, 0x0b7b, 0x3939, 0xa9f8, 0x58b8, 0xc879,
     0x2828, 0xb8e9, 0x49a9, 0xd968, 0xeb2a, 0x7beb, 0x8aab, 0x1a6a,
     0xee2f, 0x7eee, 0x8fae, 0x1f6f, 0x2d2d, 0xbdec, 0x4cac, 0xdc6d,
     0xe425, 0x74e4, 0x85a4, 0x1565, 0x2727, 0xb7e6, 0x46a6, 0xd667,
     0x2222, 0xb2e3, 0x43a3, 0xd362, 0xe120, 0x71e1, 0x80a1, 0x1060,
     0xa061, 0x30a0, 0xc1e0, 0x5121, 0x6363, 0xf3a2, 0x02e2, 0x9223,
     0x6666, 0xf6a7, 0x07e7, 0x9726, 0xa564, 0x35a5, 0xc4e5, 0x5424,
     0x6c6c, 0xfcad, 0x0ded, 0x9d2c, 0xaf6e, 0x3faf, 0xceef, 0x5e2e,
     0xaa6b, 0x3aaa, 0xcbea, 0x5b2b, 0x6969, 0xf9a8, 0x08e8, 0x9829,
     0x7878, 0xe8b9, 0x19f9, 0x8938, 0xbb7a, 0x2bbb, 0xdafb, 0x4a3a,
     0xbe7f, 0x2ebe, 0xdffe, 0x4f3f, 0x7d7d, 0xedbc, 0x1cfc, 0x8c3d,
     0xb475, 0x24b4, 0xd5f4, 0x4535, 0x7777, 0xe7b6, 0x16f6, 0x8637,
     0x7272, 0xe2b3, 0x13f3, 0x8332, 0xb170, 0x21b1, 0xd0f1, 0x4030,
     0x5050, 0xc091, 0x31d1, 0xa110, 0x9352, 0x0393, 0xf2d3, 0x6212,
     0x9657, 0x0696, 0xf7d6, 0x6717, 0x5555, 0xc594, 0x34d4, 0xa415,
     0x9c5d, 0x0c9c, 0xfddc, 0x6d1d, 0x5f5f, 0xcf9e, 0x3ede, 0xae1f,
     0x5a5a, 0xca9b, 0x3bdb, 0xab1a, 0x9958, 0x0999, 0xf8d9, 0x6818,
     0x8849, 0x1888, 0xe9c8, 0x7909, 0x4b4b, 0xdb8a, 0x2aca, 0xba0b,
     0x4e4e, 0xde8f, 0x2fcf, 0xbf0e, 0x8d4c, 0x1d8d, 0xeccd, 0x7c0c,
     0x4444, 0xd485, 0x25c5, 0xb504, 0x8746, 0x1787, 0xe6c7, 0x7606,
     0x8243, 0x1282, 0xe3c2, 0x7303, 0x4141, 0xd180, 0x20c0, 0xb001}};

crc_t crc_update(const void *data, size_t data_len) {
    const unsigned char *d = (const unsigned char *)data;
    unsigned int tbl_idx;

    crc_t crc = 0xffff;
    /* Align to a multiple of 16 bytes */
    while (data_len && (((uintptr_t)(const void *)d) % 16 != 0)) {
        tbl_idx = (crc ^ *d) & 0xff;
        crc = (crc_table[0][tbl_idx] ^ (crc >> 8)) & 0xffff;
        d++;
        data_len--;
    }

    const uint32_t *d32 = (const uint32_t *)d;
    while (data_len >= 16) {
        crc_t d1 = *d32++ ^ crc;
        crc_t d2 = *d32++;
        crc_t d3 = *d32++;
        crc_t d4 = *d32++;
        crc =
            crc_table[0][(d4 >> 24) & 0xffu] ^
            crc_table[1][(d4 >> 16) & 0xffu] ^
            crc_table[2][(d4 >> 8) & 0xffu] ^
            crc_table[3][d4 & 0xffu] ^
            crc_table[4][(d3 >> 24) & 0xffu] ^
            crc_table[5][(d3 >> 16) & 0xffu] ^
            crc_table[6][(d3 >> 8) & 0xffu] ^
            crc_table[7][d3 & 0xffu] ^
            crc_table[8][(d2 >> 24) & 0xffu] ^
            crc_table[9][(d2 >> 16) & 0xffu] ^
            crc_table[10][(d2 >> 8) & 0xffu] ^
            crc_table[11][d2 & 0xffu] ^
            crc_table[12][(d1 >> 24) & 0xffu] ^
            crc_table[13][(d1 >> 16) & 0xffu] ^
            crc_table[14][(d1 >> 8) & 0xffu] ^
            crc_table[15][d1 & 0xffu];

        data_len -= 16;
    }

    /* Remaining bytes with the standard algorithm */
    d = (const unsigned char *)d32;
    while (data_len--) {
        tbl_idx = (crc ^ *d) & 0xff;
        crc = (crc_table[0][tbl_idx] ^ (crc >> 8)) & 0xffff;
        d++;
    }
    return (crc & 0xffff) ^ 0xffff;
}